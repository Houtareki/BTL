<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n L√Ω Phim</title>
    <link rel="stylesheet" href="/css/AdminMovie.css"> 
</head>
<body>

<div class="movie-manager-container">
    <h1>üé¨ Qu·∫£n L√Ω Danh S√°ch Phim</h1>

    <button class="btn-open-modal" id="openAddModalBtn">Th√™m Phim M·ªõi</button>

    <div class="pagination-container">
        <div class="pagination-info" id="paginationInfo">ƒêang t·∫£i...</div>
        <div class="pagination-buttons">
            <button class="btn-pagination" id="btnPrevious" disabled>‚Üê Previous</button>
            <span class="page-indicator" id="pageIndicator">Trang 1</span>
            <button class="btn-pagination" id="btnNext" disabled>Next ‚Üí</button>
        </div>
    </div>

    <table class="movie-list-table" id="movieTable">
        <thead>
            <tr>
                <th>ID Phim</th>
                <th>T√™n Phim</th>
                <th>NƒÉm</th>
                <th>Qu·ªëc Gia</th>
                <th>H√†nh ƒê·ªông</th>
            </tr>
        </thead>
        <tbody id="movieTableBody">
            <tr>
                <td colspan="5" style="text-align:center;">ƒêang t·∫£i d·ªØ li·ªáu...</td>
            </tr>
        </tbody>
    </table>
</div>

<!-- Modal th√™m/s·ª≠a phim -->
<div id="movieModal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-header">
            <h2 id="modalTitle">Th√™m Phim M·ªõi</h2>
            <span class="close-button" id="closeModalBtn">&times;</span>
        </div>

        <form id="movieForm" class="movie-form">
            <input type="hidden" id="movieId">

            <div class="form-group">
                <label for="title">T√™n Phim</label>
                <input type="text" id="title" required placeholder="Nh·∫≠p t√™n phim">
            </div>

            <div class="form-group">
                <label for="description">M√¥ T·∫£</label>
                <textarea id="description" required placeholder="Nh·∫≠p m√¥ t·∫£ phim"></textarea>
            </div>

            <div class="form-group">
                <label for="releaseYear">NƒÉm Ph√°t H√†nh</label>
                <input type="number" id="releaseYear" required min="1900" max="2100" placeholder="V√≠ d·ª•: 2024">
            </div>

            <div class="form-group">
                <label for="country">Qu·ªëc Gia</label>
                <input type="text" id="country" required placeholder="Nh·∫≠p qu·ªëc gia">
            </div>
            
            <div class="form-group">
                <label for="posterUrl">Poster Phim</label>
                <input type="hidden" id="posterUrl" required>
                <div class="poster-upload-wrapper">
                    <div class="poster-preview-box">
                        <img id="posterPreview" class="poster-preview" src="" alt="Poster Preview" style="display: none;">
                        <div id="posterPlaceholder" class="poster-placeholder">
                            <span class="placeholder-icon">üñºÔ∏è</span>
                            <span class="placeholder-text">Ch∆∞a c√≥ ·∫£nh</span>
                        </div>
                    </div>
                    <button type="button" class="btn-upload-poster" id="btnUploadPoster">
                        <span class="upload-icon">üì§</span>
                        <span>Ch·ªçn ·∫¢nh</span>
                    </button>
                    <input type="file" id="posterFileInput" accept="image/*" style="display: none;">
                </div>
            </div>

            <!-- Ph·∫ßn hi·ªÉn th·ªã episodes -->
            <div class="form-section" id="episodesSection" style="display: none;">
                <div class="section-header">
                    <h3>üì∫ Danh S√°ch T·∫≠p Phim</h3>
                    <button type="button" class="btn-add-item" id="btnAddEpisode">
                        <span>‚ûï</span> Th√™m T·∫≠p Phim
                    </button>
                </div>
                <div id="episodesList" class="episodes-container">
                    <!-- Episodes s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
                </div>
            </div>

            <!-- Ph·∫ßn hi·ªÉn th·ªã actors -->
            <div class="form-section" id="actorsSection" style="display: none;">
                <div class="section-header">
                    <h3>üé≠ Di·ªÖn Vi√™n</h3>
                    <button type="button" class="btn-add-item" id="btnAddActor">
                        <span>‚ûï</span> Th√™m Di·ªÖn Vi√™n
                    </button>
                </div>
                <div id="actorsList" class="tags-container">
                    <!-- Actors s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
                </div>
            </div>

            <!-- Ph·∫ßn hi·ªÉn th·ªã genres -->
            <div class="form-section" id="genresSection" style="display: none;">
                <div class="section-header">
                    <h3>üé¨ Th·ªÉ Lo·∫°i</h3>
                    <button type="button" class="btn-add-item" id="btnAddGenre">
                        <span>‚ûï</span> Th√™m Th·ªÉ Lo·∫°i
                    </button>
                </div>
                <div id="genresList" class="tags-container">
                    <!-- Genres s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
                </div>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn-save">L∆∞u L·∫°i</button>
            </div>
        </form>
    </div>
</div>

<!-- Modal ch·ªçn di·ªÖn vi√™n -->
<div id="actorSelectModal" class="modal-overlay" style="display: none;">
    <div class="modal-content modal-select">
        <div class="modal-header">
            <h2>Ch·ªçn Di·ªÖn Vi√™n</h2>
            <span class="close-button" id="closeActorModalBtn">&times;</span>
        </div>
        <div class="modal-body">
            <input type="text" id="actorSearchInput" class="search-input" placeholder="üîç T√¨m ki·∫øm di·ªÖn vi√™n...">
            <div id="actorSelectList" class="select-list">
                <!-- Danh s√°ch actors s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
            </div>
        </div>
    </div>
</div>

<!-- Modal ch·ªçn th·ªÉ lo·∫°i -->
<div id="genreSelectModal" class="modal-overlay" style="display: none;">
    <div class="modal-content modal-select">
        <div class="modal-header">
            <h2>Ch·ªçn Th·ªÉ Lo·∫°i</h2>
            <span class="close-button" id="closeGenreModalBtn">&times;</span>
        </div>
        <div class="modal-body">
            <input type="text" id="genreSearchInput" class="search-input" placeholder="üîç T√¨m ki·∫øm th·ªÉ lo·∫°i...">
            <div id="genreSelectList" class="select-list">
                <!-- Danh s√°ch genres s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
            </div>
        </div>
    </div>
</div>

<!-- Modal th√™m/s·ª≠a episode -->
<div id="episodeModal" class="modal-overlay" style="display: none;">
    <div class="modal-content modal-select">
        <div class="modal-header">
            <h2 id="episodeModalTitle">Th√™m T·∫≠p Phim</h2>
            <span class="close-button" id="closeEpisodeModalBtn">&times;</span>
        </div>
        <div class="modal-body">
            <input type="hidden" id="episodeEditIndex">
            <input type="hidden" id="episodeVideoUrl" required>
            <div class="form-group">
                <label for="episodeName">T√™n T·∫≠p</label>
                <input type="text" id="episodeName" class="search-input" placeholder="V√≠ d·ª•: T·∫≠p 1, Episode 1" required>
            </div>
            <div class="form-group">
                <label for="episodeVideo">Video File</label>
                <div class="video-upload-wrapper">
                    <div class="video-preview-container">
                        <video id="videoPreview" class="video-preview" controls style="display: none;">
                            <source src="" type="video/mp4">
                            Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ video.
                        </video>
                        <div id="videoPlaceholder" class="video-placeholder">
                            <span class="placeholder-icon">üé¨</span>
                            <span class="placeholder-text">Ch∆∞a c√≥ video</span>
                        </div>
                    </div>
                    <div class="video-info-box" id="videoInfoBox">
                        <span class="video-icon">üìπ</span>
                        <span class="video-name" id="videoFileName">Ch∆∞a ch·ªçn file</span>
                    </div>
                    <button type="button" class="btn-upload-video" id="btnUploadVideo">
                        <span class="upload-icon">üì§</span>
                        <span>Ch·ªçn Video</span>
                    </button>
                    <input type="file" id="episodeVideoFileInput" accept="video/*" style="display: none;">
                </div>
            </div>
            <div class="form-actions">
                <button type="button" class="btn-save" id="btnSaveEpisode">L∆∞u</button>
                <button type="button" class="btn-cancel" id="btnCancelEpisode">H·ªßy</button>
            </div>
        </div>
    </div>
</div>

<!-- Toast Container -->
<div class="toast-container" id="toastContainer"></div>

<script src="/js/AdminMovie.js"></script>
<script>
document.getElementById("movieForm").addEventListener("submit", function(e) {
    const year = document.getElementById("releaseYear").value;
    const poster = document.getElementById("posterUrl").value;

    // Validate nƒÉm
    if (isNaN(year) || year < 1900 || year > 2100) {
        e.preventDefault();
        alert("‚ùå NƒÉm ph√°t h√†nh kh√¥ng h·ª£p l·ªá!");
        return;
    }

    // Validate poster b·∫Øt bu·ªôc
    if (!poster || poster.trim() === "") {
        e.preventDefault();
        alert("‚ùå B·∫°n ph·∫£i ch·ªçn poster cho phim!");
        return;
    }
});
</script>

</body>
</html>
